# Global Configuration for DevSecOps Stack
# This file contains shared configuration used across all Helm charts

# Global settings
global:
  # ArgoCD configuration
  argocd:
    repoURL: https://github.com/Ashutosh-730/devsecops
    targetRevision: ashutosh-dev
  
  # Kubernetes cluster configuration
  clusterDomain: cluster.local
  
  # Image Pull Policy
  imagePullPolicy: IfNotPresent
  
  # Deployment Configuration
  revisionHistoryLimit: 1  # Keep only 1 old ReplicaSet for rollback
  
  # Storage Configuration
  storage:
    storageClass: standard
    # Default sizes for different application types
    sizes:
      small: 2Gi    # alertmanager
      medium: 5Gi   # grafana, prometheus, loki
      large: 10Gi   # jenkins
  
  # Resource Defaults (can be referenced by name in individual charts)
  resources:
    small:
      limits:
        cpu: 200m
        memory: 256Mi
      requests:
        cpu: 100m
        memory: 128Mi
    
    medium:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 250m
        memory: 256Mi
    
    large:
      limits:
        cpu: 1000m
        memory: 1Gi
      requests:
        cpu: 500m
        memory: 512Mi
    
    xlarge:
      limits:
        cpu: 2000m
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 2Gi
  
  # Common service configuration
  services:
    type: ClusterIP
  
  # Application configuration
  applications:
    kong:
      enabled: true
      replicaCount: 1
      externalProxyUrl: http://localhost:8000
      image:
        repository: kong
        tag: "3.4"
      postgres:
        database: kong
        username: kong
        password: kong  # TODO: Move to secrets
    
    grafana:
      enabled: true
      replicaCount: 1
      adminUser: admin
      adminPassword: admin  # TODO: Move to secrets
      externalUrl: http://localhost:8000/grafana
      image:
        repository: grafana/grafana
        tag: 10.2.0
      plugins:
        - grafana-piechart-panel
        - grafana-clock-panel
    
    prometheus:
      enabled: true
      replicaCount: 1
      externalUrl: http://localhost:8000/prometheus
      image:
        repository: prom/prometheus
        tag: v2.45.0
      retention: 15d
      scrapeInterval: 15s
      evaluationInterval: 15s
    
    alertmanager:
      enabled: true
      replicaCount: 1
      externalUrl: http://localhost:8000/alertmanager
      image:
        repository: prom/alertmanager
        tag: v0.26.0
    
    jenkins:
      enabled: true
      replicaCount: 1
      adminUser: admin
      adminPassword: admin  # TODO: Move to secrets
      externalUrl: http://localhost:8000/jenkins
      image:
        repository: jenkins/jenkins
        tag: 2.426.1-lts
      plugins:
        - kubernetes:latest
        - workflow-aggregator:latest
        - git:latest
        - configuration-as-code:latest
        - prometheus:latest
        - job-dsl:latest
    
    loki:
      enabled: true
      replicaCount: 1
      image:
        repository: grafana/loki
        tag: 2.9.0
      promtail:
        image:
          repository: grafana/promtail
          tag: 2.9.0
