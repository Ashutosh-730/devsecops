# Use global configuration from values-global.yaml
# Override with: helm install -f values-global.yaml -f charts/kong/values.yaml

replicaCount: 1

image:
  repository: kong
  tag: "3.4"
  pullPolicy: IfNotPresent

proxy:
  type: ClusterIP
  httpPort: 8000
  httpsPort: 8443

admin:
  enabled: true
  type: ClusterIP
  port: 8001

manager:
  enabled: true
  type: ClusterIP
  port: 8002

env:
  database: "postgres"
  pg_host: "kong-postgres"
  pg_port: "5432"
  pg_database: "kong"
  pg_user: "kong"
  pg_password: "kong"
  proxy_access_log: /dev/stdout
  admin_access_log: /dev/stdout
  proxy_error_log: /dev/stderr
  admin_error_log: /dev/stderr
  admin_listen: "0.0.0.0:8001, 0.0.0.0:8444 ssl"
  admin_gui_listen: "0.0.0.0:8002"
  admin_gui_url: "http://localhost:8002"
  admin_api_uri: "http://localhost:8001"
  admin_gui_access_log: /dev/stdout
  admin_gui_error_log: /dev/stderr
  admin_gui_api_url: "http://localhost:8001"
  admin_gui_path: "/"
  # Enable RBAC and Basic Auth for Kong Manager (Enterprise feature)
  # Note: These features require Kong Enterprise license
  enforce_rbac: "on"
  admin_gui_auth: "basic-auth"
  admin_gui_session_conf: '{"secret":"kong","storage":"kong","cookie_secure":false}'
  password: "kong"

# Prometheus plugin configuration
plugins:
  prometheus:
    enabled: true
    config:
      per_consumer: true
      status_code_metrics: true
      latency_metrics: true
      bandwidth_metrics: true
      upstream_health_metrics: true

declarativeConfig:
  enabled: false

postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "13"
  port: 5432
  database: "kong"
  username: "kong"
  password: "kong"
  persistence:
    enabled: false
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi
